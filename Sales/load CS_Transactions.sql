-- SET SESSION sql_mode = '';
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190301-20190315.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190316-20190331.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190401-20190415.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190416-20190430.csv'


-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190501-20190515.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190516-20190531.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190601-20190615.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190616-20190630.csv'

-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190701.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190702.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190703.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190704.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190705.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190706.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190707.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190708.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190709.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190710.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190711.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190712.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190713.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190714.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190715.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190716.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190717.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190718.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190719.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190720.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190721.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190722.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190723.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190724.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190725.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190726.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190727.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190728.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190729.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190730.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190731.csv'

-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190801.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190802.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190803.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190804.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190805.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190806.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190807.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190808.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190809.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190810.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190811.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190812.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190813.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190814.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190815.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190816.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190817.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190818.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190819.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190820.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190821.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190822.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190823.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190824.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190825.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190826.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190827.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190828.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190829.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190830.csv'
-- 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190831.csv'


 	LOAD DATA LOW_PRIORITY LOCAL INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/CyberSource/CS_Transactions_20190821-20190902.csv'


REPLACE INTO TABLE `rcbill_my`.`cs_transactions` CHARACTER SET UTF8 FIELDS TERMINATED BY ',' 
OPTIONALLY ENCLOSED BY '"' ESCAPED BY '"' LINES TERMINATED BY '\n' 
IGNORE 1 LINES 
(
@cybersourcemerchantid,
@dateandtime,
@requestid,
@merchantrefno,
-- @clientcode,
-- @paymentdate,
@lastname,
@firstname,
@emailaddress,
@paymentamount,
@paymentcurrency,
@accountsuffix,
@applications,
@accounttype,
@digitalpaymentmethod,
@transrefno,
@authind,
@partorigtranid,
@deviceid,
@terminalserialno,
@processor,
@tokenid,
@busapplicationid,
@terminalid,
@patranid,
@xid,
@merchantdefineddata1,
@merchantdefineddata2,
@merchantdefineddata3,
@merchantdefineddata4,
@clientuser,
@salesslipno,
@authcode,
@acqmerchantid,
@jccaterminalid,
@billingaddress1,
@billingcity,
@billingstate,
@billingpostalcode,
@billingphoneno,
@ipaddress,
@billingcountry,
@shipfirstname,
@shiplastname,
@shipaddress1,
@shipcity,
@shipstate,
@shipcountry,
@shippostalcode,
@shipphoneno,
@customerid,
@clientapplication

) 
set 
  
CYBERSOURCEMERCHANTID=@cybersourcemerchantid ,
DATEANDTIME=str_to_date(@dateandtime,'%b %d %Y %h:%i:%s %p GST') ,
REQUESTID=@requestid , 
MERCHANTREFNO=@merchantrefno,
CLIENTCODE=upper(trim(SUBSTRING_INDEX(@merchantrefno,'/',1))),
PAYMENTDATE=str_to_date(SUBSTRING_INDEX(@merchantrefno,'/',-1),'%d.%m.%Y %H:%i:%s'),
LASTNAME=upper(trim(@lastname)),
FIRSTNAME=upper(trim(@firstname)),
EMAILADDRESS=trim(@emailaddress),
PAYMENTAMOUNT=@paymentamount ,
PAYMENTCURRENCY=@paymentcurrency,
ACCOUNTSUFFIX=@accountsuffix,
APPLICATIONS=@applications,
ACCOUNTTYPE=@accounttype,
DIGITALPAYMENTMETHOD=@digitalpaymentmethod,
TRANSREFNO=@transrefno,
AUTHIND=@authind,
PARTORIGTRANID=@partorigtranid,
DEVICEID=@deviceid,
TERMINALSERIALNO=@terminalserialno,
PROCESSOR=@processor,
TOKENID=@tokenid,
BUSAPPLICATIONID=@busapplicationid,
TERMINALID=@terminalid,
PATRANID=@patranid,
XID=@xid,
MerchantDefinedData1=@merchantdefineddata1,
MerchantDefinedData2=@merchantdefineddata2,
MerchantDefinedData3=@merchantdefineddata3,
MerchantDefinedData4=@merchantdefineddata4,
CLIENTUSER=@clientuser,
SALESSLIPNO=@salesslipno,
AUTHCODE=@authcode,
ACQMERCHANTID=@acqmerchantid,
JCCATERMINALID=@jccaterminalid,
BILLINGADDRESS1=@billingaddress1,
BILLINGCITY=@billingcity,
BILLINGSTATE=@billingstate,
BILLINGPOSTALCODE=@billingpostalcode,
BILLINGPHONENO=@billingphoneno,
IPADDRESS=@ipaddress,
BILLINGCOUNTRY=@billingcountry,
SHIPFIRSTNAME=@shipfirstname,
SHIPLASTNAME=@shiplastname,
SHIPADDRESS1=@shipaddress1,
SHIPCITY=@shipcity,
SHIPSTATE=@shipstate,
SHIPCOUNTRY=@shipcountry,
SHIPPOSTALCODE=@shippostalcode,
SHIPPHONENO=@shipphoneno,
CUSTOMERID=@customerid,
CLIENTAPPLICATION=@clientapplication,
INSERTEDON=now()

;

select * from rcbill_my.cs_transactions; -- where date(DATEANDTIME)='2019-07-26';

select date(dateandtime), count(*) from rcbill_my.cs_transactions
group by 1
order by 1 desc
;

-- set SQL_SAFE_UPDATES=0;
-- delete from rcbill_my.cs_transactions where date(DATEANDTIME)='2019-07-26';

